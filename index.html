<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æ¨¹å¥åº·è³¼ç‰©ç¶² - Pharma.Duck æ™ºæ…§å°è³¼ç¤ºç¯„</title>
    <style>
        /* åŸºç¤è¨­å®š */
        :root {
            --greattree-green: #009944;
            --greattree-orange: #F39800;
            --bg-gray: #f5f5f5;
        }
        body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; padding: 0; background-color: var(--bg-gray); }
        
        /* æ¨¡æ“¬å°èˆªåˆ— (Logo ä¿®æ”¹è™•) */
        header { background: white; padding: 10px 0; border-bottom: 3px solid var(--greattree-green); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .nav-container { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        
        /* ä¿®æ”¹ï¼šLogo å€å¡Šç¾åœ¨åŒ…å«åœ–ç‰‡ */
        .logo { display: flex; align-items: center; }
        .logo img { height: 50px; width: auto; } /* è¨­å®š Logo é«˜åº¦ */

        .search-bar { flex-grow: 1; margin: 0 40px; display: flex; }
        .search-bar input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px 0 0 4px; outline: none;}
        .search-bar button { padding: 10px 20px; background: var(--greattree-green); color: white; border: none; border-radius: 0 4px 4px 0; cursor: pointer; }
        .nav-links { font-size: 14px; color: #666; }

        /* å•†å“åˆ—è¡¨æ¨¡æ“¬ */
        .main-content { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .banner { width: 100%; height: 300px; background: linear-gradient(to right, #e0e0e0, #f0f0f0); border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: center; align-items: center; color: #888; font-size: 24px; font-weight: bold;}
        .product-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .product-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: 0.3s; position: relative; border: 2px solid transparent;}
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .tag-rec { position: absolute; top: -2px; right: -2px; background: var(--greattree-orange); color: white; padding: 4px 12px; font-size: 12px; border-radius: 0 8px 0 8px; display: none; z-index: 2; font-weight: bold;}
        /* æ‰¾åˆ°åŸæœ¬çš„ .p-img ä¿®æ”¹å…§å®¹å¦‚ä¸‹ */
    .p-img { 
        width: 100%;       /* å¯¬åº¦å¡«æ»¿ */
        height: 150px;     /* é«˜åº¦å›ºå®š */
        object-fit: contain; /* ä¿æŒæ¯”ä¾‹ï¼Œæ•´å¼µåœ–éƒ½çœ‹å¾—åˆ° (é©åˆè—¥ç½) */
        /* æˆ–è€…ç”¨ object-fit: cover; (å¡«æ»¿æ ¼å­ï¼Œä½†å¯èƒ½æœƒåˆ‡åˆ°é‚Šé‚Š) */
        margin-bottom: 10px; 
        background: #fff;  /* èƒŒæ™¯æ”¹ç™½è‰²æ¯”è¼ƒä¹¾æ·¨ */
    }
        .p-name { font-weight: bold; margin-bottom: 5px; height: 40px; overflow: hidden; font-size: 15px;}
        .p-price { color: #d0021b; font-weight: bold; font-size: 18px; }

        /* ä¿®æ”¹ï¼šå³ä¸‹è§’å¤§å‹å°è³¼é´¨é´¨ (å–ä»£åŸæœ¬çš„åœ“å½¢æŒ‰éˆ•) */
        .duck-assistant-large {
            position: fixed;
            bottom: 0px; /* è²¼åº•ç«™ç«‹ */
            right: 20px;
            width: 220px; /* è¨­å®šå¯¬åº¦ï¼Œè®“å®ƒçœ‹èµ·ä¾†å¤ å¤§ */
            height: auto;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        /* æ»‘é¼ ç§»éå»æ™‚ç¨å¾®æµ®èµ· */
        .duck-assistant-large:hover {
            transform: translateY(-10px);
        }
        .duck-assistant-large img {
            width: 100%;
            height: auto;
            display: block;
            /* åŠ ä¸Šé™°å½±å¢åŠ ç«‹é«”æ„Ÿ */
            filter: drop-shadow(2px 5px 15px rgba(0,0,0,0.3));
        }

        /* Pharma.Duck å°è©±è¦–çª— */
        .duck-chat-window {
            position: fixed;
            bottom: 200px; /* èª¿æ•´è¦–çª—ä½ç½®ï¼Œé¿å…æ“‹ä½å¤§é´¨é´¨ */
            right: 50px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: none; /* é è¨­éš±è— */
            flex-direction: column;
            z-index: 1001; /* æ¯”é´¨å­æ›´é«˜ä¸€å±¤ */
            overflow: hidden;
            border: 1px solid #ddd;
        }
        
        /* èŠå¤©è¦–çª—é ­éƒ¨ */
        .chat-header {
            background: var(--greattree-green); color: white; padding: 15px; display: flex; align-items: center;
        }
        .chat-header-img { width: 40px; height: 40px; background: white; border-radius: 50%; margin-right: 10px; overflow: hidden; border: 2px solid var(--greattree-orange);}
        .chat-header-img img { width: 100%; height: 100%; object-fit: cover; }

        /* èŠå¤©å…§å®¹å€ */
        .chat-messages {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background: #fafafa;
        }
        .msg { margin-bottom: 12px; max-width: 85%; line-height: 1.4; font-size: 14px; }
        .msg-duck { align-self: flex-start; }
        .msg-duck .bubble { background: white; padding: 12px 16px; border-radius: 18px 18px 18px 4px; border: 1px solid #eee; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .msg-user { align-self: flex-end; margin-left: auto; text-align: right; }
        .msg-user .bubble { background: var(--greattree-green); color: white; padding: 10px 14px; border-radius: 18px 18px 4px 18px; display: inline-block; }
        
        /* æ¨è–¦å•†å“å¡ç‰‡ (åœ¨å°è©±ä¸­) */
        .rec-card {
            background: white;
            border: 2px solid var(--greattree-orange);
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
            display: flex;
            gap: 10px;
            cursor: pointer;
            transition: 0.2s;
        }
        .rec-card:hover { background: #fffbe6; }
        .rec-card img { width: 60px; height: 60px; background: #ddd; object-fit: cover; border-radius: 4px;}
        .rec-info { flex-grow: 1; }
        .rec-title { font-weight: bold; font-size: 14px; color: var(--greattree-green); }
        .rec-reason { font-size: 12px; color: #666; margin-top: 4px; line-height: 1.3; }
        .rec-action { margin-top: 8px; font-size: 12px; color: var(--greattree-orange); font-weight: bold; text-align: right;}

        /* è¼¸å…¥å€ */
        .chat-input-area {
            padding: 10px;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
        }
        .chat-input-area input {
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            outline: none;
        }
        .chat-input-area button {
            background: var(--greattree-orange);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
/* === æ–°å¢ï¼šé å°¾æ¨£å¼ === */
    footer {
        background-color: #333; /* æ·±ç°è‰²èƒŒæ™¯ */
        color: white;           /* ç™½è‰²æ–‡å­— */
        text-align: center;     /* æ–‡å­—ç½®ä¸­ */
        padding: 20px 0;        /* ä¸Šä¸‹ç•™ç™½ */
        margin-top: 50px;       /* è·Ÿä¸Šæ–¹å•†å“å€éš”é–‹ */
        font-size: 14px;
        line-height: 1.6;
    }
    footer .team-info {
        color: #F39800; /* å¤§æ¨¹æ©˜ï¼Œå¼·èª¿éšŠå */
        font-weight: bold;
        font-size: 16px;
    }
        .typing { font-size: 12px; color: #888; margin-left: 15px; margin-bottom: 10px; display: none; font-style: italic;}
    </style>
</head>
<body>

<header>
    <div class="nav-container">
        <div class="logo">
        <img src="greattree.jpg" alt="å¤§æ¨¹è—¥å±€ Logo"> 
        </div>
        <div class="search-bar">
            <input type="text" placeholder="æœå°‹å•†å“ã€å“ç‰Œæˆ–è¼¸å…¥ç—‡ç‹€ (Demoç‰ˆ)...">
            <button>æœå°‹</button>
        </div>
        <div class="nav-links">æœƒå“¡ç™»å…¥ | è³¼ç‰©è»Š(0) | é–€å¸‚æŸ¥è©¢</div>
    </div>
</header>

<div class="main-content">
    <div class="banner">ğŸ‰ Pharma.Duck å°é´¨è—¥å¸« å…¨æ–°ä¸Šç·šï¼</div>
    <h2 style="color: #333;">ç†±é–€ä¿å¥å“</h2>
    <div class="product-grid" id="productGrid">
        </div>
</div>

<div class="duck-assistant-large" onclick="toggleChat()">
    <img src="my_duck.png" alt="Ph.D é´¨é´¨å°è³¼">
</div>

<div class="duck-chat-window" id="chatWindow">
    <div class="chat-header">
        <div class="chat-header-img">
            <img src="my_duck.png" alt="é´¨">
        </div>
        <div style="font-weight: bold;">Ph.D é´¨å­è—¥å¸« (ç·šä¸Šè«®è©¢)</div>
        <div style="margin-left: auto; cursor: pointer; font-size: 20px;" onclick="toggleChat()">âœ•</div>
    </div>

    <div class="chat-messages" id="chatMsg">
        <div class="msg msg-duck">
            <div class="bubble">æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„å°ˆå±¬å¥åº·é¡§å• Ph.D é´¨é´¨ã€‚ğŸ¦†<br>ä»Šå¤©æƒ³æ‰¾ä»€éº¼æ–¹é¢çš„ä¿å¥å“å‘¢ï¼Ÿæˆ‘å¯ä»¥å¹«æ‚¨æ¯”è¼ƒæˆåˆ†å–”ï¼âœ¨</div>
        </div>
    </div>
    
    <div class="typing" id="typingIndicator">é´¨é´¨æ­£åœ¨æ€è€ƒä¸­... ğŸ¤”</div>

    <div class="chat-input-area">
        <input type="text" id="userInput" placeholder="è¼¸å…¥ç—‡ç‹€ï¼Œä¾‹ï¼šå¥¶å¥¶è†è“‹ç—›..." onkeypress="handleKeyPress(event)">
        <button onclick="sendMessage()">â¤</button>
    </div>
</div>
<footer>
    <div class="team-info">åœ˜éšŠï¼šä¸€é´¨treeåƒ ğŸ¦†</div>
    <div>å˜‰å—è—¥ç†å¤§å­¸ è—¥å­¸ç³»</div>
    <div style="font-size: 12px; color: #aaa; margin-top: 5px;">
        æœ¬ç¶²é åƒ…ä¾›ã€å¤§æ¨¹è—¥å±€ç¬¬ä¸‰å±†å‰µæ„ç«¶è³½ã€‘å±•ç¤ºä½¿ç”¨ï¼ŒéçœŸå¯¦è³¼ç‰©ç¶²ç«™<br>
        Copyright Â© 2026 Pharma.Duck. All rights reserved.
    </div>
</footer>
<script>

  // æ¨¡æ“¬å•†å“è³‡æ–™åº« (åŒ…å«é©ç”¨å°è±¡èˆ‡æˆåˆ†æ¨™è¨˜)
    const products = [
        // è€äºº/æˆäºº - é—œç¯€ (å«è¦èŸ¹)
        { id: 1, name: "å¤§æ¨¹ è‘¡è„ç³–èƒºé£² (ä¸€èˆ¬æ¬¾)", price: 600, tag: "é—œç¯€ä¿é¤Š", image: "p_gluco.jpg", imgColor: "#b2dfdb", target: "adult,senior", allergy: "shellfish" },
        // è€äºº/æˆäºº - é—œç¯€ (UC-II ä¸å«è¦èŸ¹ï¼Œé©åˆéæ•è€…)
        { id: 2, name: "æŒºç«‹ é—œéµè¿·ä½ éŒ  UC-II", price: 1580, tag: "é—œç¯€ä¿é¤Š", image: "p_ucii.jpg", imgColor: "#ffcdd2", target: "adult,senior", allergy: "none" },
        // å¬°å¹¼å…’ - è…¸èƒƒ
        { id: 3, name: "å¦™åˆ©æ•£ ç›Šç”ŸèŒ (ç²‰æœ«)", price: 850, tag: "å¬°å¹¼å…’è…¸èƒƒ", image: "p_baby_bio.jpg", imgColor: "#fff9c4", target: "baby,child", allergy: "none" },
        // æˆäºº - è…¸èƒƒ
        { id: 4, name: "è‹¥å…ƒéŒ  Wakamoto", price: 600, tag: "æˆäººè…¸èƒƒ", image: "p_waka.jpg", imgColor: "#e1bee7", target: "adult", allergy: "none" },
        // ä¸€èˆ¬ - ç¶­ä»–å‘½
        { id: 5, name: "èŠèƒç¾ ç¶œåˆç¶­ä»–å‘½", price: 900, tag: "åŸºç¤ä¿é¤Š", image: "p_vit.jpg", imgColor: "#c8e6c9", target: "adult", allergy: "none" },
    ];
    // åˆå§‹åŒ–å•†å“åˆ—è¡¨
    const grid = document.getElementById('productGrid');
    products.forEach(p => {
        grid.innerHTML += `
            <div class="product-card" id="pid-${p.id}">
                <div class="tag-rec">é´¨é´¨æ¨è–¦ âœ¨</div>
                <div class="p-img" style="background:${p.imgColor}">å•†å“åœ–</div>
                <div class="p-name">${p.name}</div>
                <div class="p-price">$${p.price}</div>
            </div>
        `;
    });

    // èŠå¤©å®¤é–‹é—œ
    function toggleChat() {
        const win = document.getElementById('chatWindow');
        win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
        // æ‰“é–‹æ™‚è‡ªå‹•èšç„¦è¼¸å…¥æ¡†
        if (win.style.display === 'flex') {
            document.getElementById('userInput').focus();
        }
    }

    // è™•ç†æŒ‰éµ
    function handleKeyPress(e) {
        if (e.key === 'Enter') sendMessage();
    }

    // ç™¼é€è¨Šæ¯é‚è¼¯ (æ¨¡æ“¬å¾Œç«¯)
    // === å…¨æ–°çš„å°è©±ç‹€æ…‹ç®¡ç† ===
    let chatStep = 0; // 0:ç­‰å¾…ç—‡ç‹€, 1:ç­‰å¾…å°è±¡, 2:ç­‰å¾…éæ•å²
    let userProfile = { symptom: "", who: "", allergy: "" }; // æš«å­˜å®¢äººéœ€æ±‚

    function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        if (!text) return;

        // é¡¯ç¤ºä½¿ç”¨è€…è¨Šæ¯
        addMessage(text, 'user');
        input.value = '';
        showTyping(true);

        setTimeout(() => {
            let response = "";
            let recProductId = null;
            let recReasonText = "";

            // --- æ­¥é©Ÿ 0: å‰›é–‹å§‹ï¼Œå®¢äººåœ¨è¬›ç—‡ç‹€ ---
            if (chatStep === 0) {
                userProfile.symptom = text; // è¨˜ä½ç—‡ç‹€
                
                // åˆ¤æ–·æ˜¯å¦ç‚ºçµæŸæˆ–é‡ç½®
                if(text.includes("é‡ä¾†") || text.includes("è¬è¬")) {
                    response = "ä¸å®¢æ°£ï¼éš¨æ™‚æ­¡è¿å›ä¾†æ‰¾é´¨é´¨ã€‚ğŸ¦† (å°è©±å·²é‡ç½®)";
                    chatStep = 0;
                } else {
                    // é€²å…¥ä¸‹ä¸€æ­¥ï¼šå•å°è±¡
                    response = `æ”¶åˆ°ï¼Œæ‚¨æƒ³æ‰¾æ”¹å–„ã€Œ${text}ã€çš„ç”¢å“ã€‚ğŸ¦†<br><br>è«‹å•é€™ä¸»è¦æ˜¯çµ¦èª°ä½¿ç”¨çš„å‘¢ï¼Ÿ<br>(ä¾‹å¦‚ï¼šå¬°å…’ã€å°å­©ã€æˆäººã€è€äººï¼Ÿæ€§åˆ¥ï¼Ÿ)`;
                    chatStep = 1; // åˆ‡æ›ç‹€æ…‹
                }
            } 
            
            // --- æ­¥é©Ÿ 1: å®¢äººå›ç­”äº†å°è±¡ (å¹´é½¡/æ€§åˆ¥) ---
            else if (chatStep === 1) {
                userProfile.who = text; // è¨˜ä½å°è±¡
                
                // é€²å…¥ä¸‹ä¸€æ­¥ï¼šå•éæ•
                response = "äº†è§£ã€‚æœ€å¾Œç¢ºèªä¸€ä¸‹ï¼Œä½¿ç”¨è€…æœ‰å°ä»€éº¼é£Ÿç‰©æˆ–è—¥ç‰©**éæ•**å—ï¼Ÿ<br>æˆ–æ˜¯æ­£åœ¨æœç”¨ä»€éº¼æ…¢æ€§ç—…è—¥ç‰©ï¼Ÿ(è‹¥ç„¡è«‹è¼¸å…¥ã€Œç„¡ã€)";
                chatStep = 2; // åˆ‡æ›ç‹€æ…‹
            }

            // --- æ­¥é©Ÿ 2: å®¢äººå›ç­”äº†éæ•å² -> æœ€çµ‚æ¨è–¦ ---
            else if (chatStep === 2) {
                userProfile.allergy = text; // è¨˜ä½éæ•
                chatStep = 0; // æµç¨‹çµæŸï¼Œé‡ç½®å›æ­¥é©Ÿ 0

                // === é´¨é´¨å¤§è…¦ (ç°¡æ˜“é‚è¼¯åˆ¤æ–·) ===
                
                // æƒ…å¢ƒ A: é—œç¯€ç—› (å€åˆ†æ˜¯å¦æœ‰è¦èŸ¹éæ•)
                if (userProfile.symptom.includes("é—œç¯€") || userProfile.symptom.includes("ç—›")) {
                    if (userProfile.allergy.includes("è¦") || userProfile.allergy.includes("èŸ¹") || userProfile.allergy.includes("æµ·é®®")) {
                        // æœ‰éæ• -> æ¨ UC-II (éè¦èŸ¹ä¾†æº)
                        response = "é´¨é´¨å¹«æ‚¨åˆ†æå¥½äº†ï¼ğŸ¦†<br><br>é›–ç„¶ä¸€èˆ¬å¸¸æ¨è–¦è‘¡è„ç³–èƒºï¼Œä½†å› ç‚ºæ‚¨æåˆ°æœ‰**æµ·é®®éæ•**ï¼Œç‚ºäº†å®‰å…¨ï¼Œæˆ‘å¼·çƒˆå»ºè­°é¸æ“‡ **UC-II (éè®Šæ€§äºŒå‹è† åŸè›‹ç™½)**ã€‚<br><br>å®ƒæ˜¯å¾é›èƒ¸è»Ÿéª¨èƒå–ï¼Œä¸å«è¦èŸ¹éæ•åŸï¼Œå°é•·è¼©é—œç¯€ä¿é¤Šæ•ˆæœä¹Ÿå¾ˆå¥½ï¼";
                        recProductId = 2; // UC-II
                        recReasonText = "âš ï¸ é¿é–‹éæ•åŸçš„å®‰å…¨é¦–é¸ï¼";
                    } else {
                        // ç„¡éæ• -> æ¨ è‘¡è„ç³–èƒº
                        response = "é‡å°é•·è¼©çš„é—œç¯€ä¿é¤Šï¼Œè‹¥æ˜¯æ²’æœ‰ç‰¹æ®Šéæ•ï¼Œé€™æ¬¾ **å¤§æ¨¹è‘¡è„ç³–èƒºé£²** æ¶²æ…‹å¥½å¸æ”¶ï¼Œæ˜¯å¾ˆå¤šé•·è¼©çš„å›è³¼é¦–é¸å–”ï¼";
                        recProductId = 1; // è‘¡è„ç³–èƒº
                        recReasonText = "æ¶²æ…‹å¥½å¸æ”¶ï¼Œç¶“å…¸ç†±éŠ·æ¬¾ã€‚";
                    }
                }
                
                // æƒ…å¢ƒ B: è‚šå­ç—›/è…¸èƒƒ (å€åˆ†æ˜¯å¬°å…’é‚„æ˜¯æˆäºº)
                else if (userProfile.symptom.includes("è‚šå­") || userProfile.symptom.includes("æ‹‰è‚šå­") || userProfile.symptom.includes("è…¸èƒƒ")) {
                    if (userProfile.who.includes("å¬°") || userProfile.who.includes("å…’") || userProfile.who.includes("å¯¶å¯¶")) {
                        // å¬°å…’ -> æ¨ å¦™åˆ©æ•£
                        response = "å¯¶å¯¶çš„è…¸èƒƒæ¯”è¼ƒæ•æ„Ÿï¼Œä¸èƒ½åƒæˆäººçš„è—¥å–”ï¼ğŸ¦†<br><br>å»ºè­°ä½¿ç”¨é€™æ¬¾ **å¦™åˆ©æ•£**ï¼Œå®ƒæ˜¯ç´°ç²‰ç‹€å¥½é¤µé£Ÿï¼Œä¸”èŒæ ªè€é…¸ï¼Œèƒ½å¹«åŠ©å¯¶å¯¶å»ºç«‹å¥åº·çš„è…¸é“ç’°å¢ƒã€‚";
                        recProductId = 3; // å¬°å…’ç›Šç”ŸèŒ
                        recReasonText = "å°ˆç‚ºå¬°å¹¼å…’è¨­è¨ˆï¼Œç´°ç²‰å¥½ååš¥ã€‚";
                    } else {
                        // æˆäºº -> æ¨ è‹¥å…ƒéŒ 
                        response = "å¦‚æœæ˜¯æˆäººæ¶ˆåŒ–ä¸è‰¯æˆ–è„¹æ°£ï¼Œæ¨è–¦é€™æ¬¾ç¶“å…¸çš„ **è‹¥å…ƒéŒ  (Wakamoto)**ï¼ŒåŒæ™‚å«æœ‰æ¶ˆåŒ–é…µç´ èˆ‡ç›Šç”ŸèŒï¼Œèƒ½æœ‰æ•ˆå¹«åŠ©æ¶ˆåŒ–ã€‚";
                        recProductId = 4; // è‹¥å…ƒéŒ 
                        recReasonText = "æ¶ˆåŒ–é…µç´ +ç›Šç”ŸèŒï¼Œé›™æ•ˆåˆä¸€ã€‚";
                    }
                }
                
                // é è¨­å›æ‡‰
                else {
                    response = "æ”¶åˆ°ï¼æ ¹æ“šæ‚¨çš„éœ€æ±‚ï¼Œæˆ‘æ•´ç†äº†ä»¥ä¸‹é©åˆçš„ç†±é–€å•†å“ä¾›æ‚¨åƒè€ƒã€‚å»ºè­°æœç”¨å‰å…ˆè«®è©¢é–€å¸‚è—¥å¸«ç¢ºèªåŠ‘é‡å–”ï¼";
                    recProductId = 5; // ç¶œåˆç¶­ä»–å‘½
                    recReasonText = "åŸºç¤ç‡Ÿé¤Šè£œå……ï¼Œé©åˆå¤§å¤šæ•¸äººã€‚";
                }
            }

            showTyping(false);
            addMessage(response, 'duck');

            if (recProductId) {
                const p = products.find(i => i.id === recProductId);
                addRecCard(p, recReasonText);
                
                // ç¶²é é€£å‹•æ•ˆæœ
                document.querySelectorAll('.product-card').forEach(c => {
                    c.style.border = "2px solid transparent";
                    c.querySelector('.tag-rec').style.display = "none";
                });
                const targetCard = document.getElementById(`pid-${p.id}`);
                if(targetCard){ // ç¢ºä¿å•†å“å¡é‚„åœ¨ç•«é¢ä¸Š
                    targetCard.style.border = "2px solid #F39800";
                    targetCard.querySelector('.tag-rec').style.display = "block";
                    setTimeout(() => {
                         targetCard.scrollIntoView({behavior: "smooth", block: "center"});
                    }, 500);
                }
            }

        }, 1000);
    }

    function addMessage(text, sender) {
        const chatBox = document.getElementById('chatMsg');
        chatBox.innerHTML += `
            <div class="msg msg-${sender}">
                <div class="bubble">${text}</div>
            </div>
        `;
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    ffunction addRecCard(product, reason) {
        const chatBox = document.getElementById('chatMsg');
        chatBox.innerHTML += `
            <div class="msg msg-duck">
                <div class="rec-card" onclick="alert('ï¼ˆæ¨¡æ“¬ï¼‰å°å¼•è‡³å•†å“é é¢: ${product.name}')">
                    
                    <img src="${product.image}" alt="${product.name}">
                    
                    <div class="rec-info">
                        <div class="rec-title">${product.name}</div>
                        <div class="rec-reason">${reason}</div>
                        <div class="rec-action">é»æ“ŠæŸ¥çœ‹è©³æƒ… ></div>
                    </div>
                </div>
            </div>
        `;
        chatBox.scrollTop = chatBox.scrollHeight;
    }
    function showTyping(show) {
        document.getElementById('typingIndicator').style.display = show ? 'block' : 'none';
    }
</script>

</body>
</html>
