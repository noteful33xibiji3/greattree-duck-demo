<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æ¨¹å¥åº·è³¼ç‰©ç¶² - Pharma.Duck æ™ºæ…§å°è³¼ç¤ºç¯„</title>
    <style>
        /* åŸºç¤è¨­å®š */
        :root {
            --greattree-green: #009944;
            --greattree-orange: #F39800;
            --bg-gray: #f5f5f5;
        }
        body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; padding: 0; background-color: var(--bg-gray); }
        
        /* æ¨¡æ“¬å°èˆªåˆ— */
        header { background: white; padding: 10px 0; border-bottom: 3px solid var(--greattree-green); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .nav-container { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        
        /* Logo å€å¡Š */
        .logo { display: flex; align-items: center; font-size: 24px; font-weight: bold; color: var(--greattree-green); }
        /* å¦‚æœä½ æœ‰ logo.png è«‹æŠŠä¸‹é¢é€™è¡Œè¨»è§£æ‰“é–‹ï¼Œä¸¦æŠŠæ–‡å­—è¨»è§£æ‰ */
        /* .logo img { height: 50px; width: auto; } */

        .search-bar { flex-grow: 1; margin: 0 40px; display: flex; }
        .search-bar input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px 0 0 4px; outline: none;}
        .search-bar button { padding: 10px 20px; background: var(--greattree-green); color: white; border: none; border-radius: 0 4px 4px 0; cursor: pointer; }
        .nav-links { font-size: 14px; color: #666; }

        /* å•†å“åˆ—è¡¨æ¨¡æ“¬ */
        .main-content { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .banner { width: 100%; height: 300px; background: linear-gradient(to right, #e0e0e0, #f0f0f0); border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: center; align-items: center; color: #888; font-size: 24px; font-weight: bold;}
        .product-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .product-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: 0.3s; position: relative; border: 2px solid transparent;}
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .tag-rec { position: absolute; top: -2px; right: -2px; background: var(--greattree-orange); color: white; padding: 4px 12px; font-size: 12px; border-radius: 0 8px 0 8px; display: none; z-index: 2; font-weight: bold;}
        
        .p-img { 
            width: 100%;       
            height: 150px;     
            object-fit: contain; 
            margin-bottom: 10px; 
            background: #fff;  
        }
        .p-name { font-weight: bold; margin-bottom: 5px; height: 40px; overflow: hidden; font-size: 15px;}
        .p-price { color: #d0021b; font-weight: bold; font-size: 18px; }

        /* å³ä¸‹è§’å¤§å‹å°è³¼é´¨é´¨ */
        .duck-assistant-large {
            position: fixed;
            bottom: 0px; 
            right: 20px;
            width: 220px; 
            height: auto;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        .duck-assistant-large:hover { transform: translateY(-10px); }
        .duck-assistant-large img {
            width: 100%;
            height: auto;
            display: block;
            filter: drop-shadow(2px 5px 15px rgba(0,0,0,0.3));
        }
/* è«‹ç¢ºä¿ .logo img æœ‰è¨­å®šé«˜åº¦æˆ–å¯¬åº¦ */
.logo img {
    height: 50px;    /* é™åˆ¶é«˜åº¦ç‚º 50 åƒç´  */
    width: auto;      /* å¯¬åº¦éš¨æ¯”ä¾‹ç¸®æ”¾ */
    object-fit: contain;
}
        /* Pharma.Duck å°è©±è¦–çª— */
        .duck-chat-window {
            position: fixed;
            bottom: 200px; 
            right: 50px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: none; 
            flex-direction: column;
            z-index: 1001; 
            overflow: hidden;
            border: 1px solid #ddd;
        }
        
        .chat-header { background: var(--greattree-green); color: white; padding: 15px; display: flex; align-items: center; }
        .chat-header-img { width: 40px; height: 40px; background: white; border-radius: 50%; margin-right: 10px; overflow: hidden; border: 2px solid var(--greattree-orange);}
        .chat-header-img img { width: 100%; height: 100%; object-fit: cover; }

        .chat-messages { flex-grow: 1; padding: 15px; overflow-y: auto; background: #fafafa; }
        .msg { margin-bottom: 12px; max-width: 85%; line-height: 1.4; font-size: 14px; }
        .msg-duck { align-self: flex-start; }
        .msg-duck .bubble { background: white; padding: 12px 16px; border-radius: 18px 18px 18px 4px; border: 1px solid #eee; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .msg-user { align-self: flex-end; margin-left: auto; text-align: right; }
        .msg-user .bubble { background: var(--greattree-green); color: white; padding: 10px 14px; border-radius: 18px 18px 4px 18px; display: inline-block; }
        
        .rec-card {
            background: white; border: 2px solid var(--greattree-orange); border-radius: 8px; padding: 10px; margin-top: 10px; display: flex; gap: 10px; cursor: pointer; transition: 0.2s;
        }
        .rec-card:hover { background: #fffbe6; }
        .rec-card img { width: 60px; height: 60px; background: #ddd; object-fit: cover; border-radius: 4px;}
        .rec-info { flex-grow: 1; }
        .rec-title { font-weight: bold; font-size: 14px; color: var(--greattree-green); }
        .rec-reason { font-size: 12px; color: #666; margin-top: 4px; line-height: 1.3; }
        .rec-action { margin-top: 8px; font-size: 12px; color: var(--greattree-orange); font-weight: bold; text-align: right;}

        .chat-input-area { padding: 10px; background: white; border-top: 1px solid #eee; display: flex; gap: 10px; }
        .chat-input-area input { flex-grow: 1; border: 1px solid #ddd; border-radius: 20px; padding: 10px 15px; outline: none; }
        .chat-input-area button { background: var(--greattree-orange); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; }

        footer { background-color: #333; color: white; text-align: center; padding: 20px 0; margin-top: 50px; font-size: 14px; line-height: 1.6; }
        footer .team-info { color: #F39800; font-weight: bold; font-size: 16px; }
        .typing { font-size: 12px; color: #888; margin-left: 15px; margin-bottom: 10px; display: none; font-style: italic;}
    </style>
</head>
<body>

<header>
    <div class="nav-container">
        <div class="logo">
            <img src="images/greattree.jpg" alt="å¤§æ¨¹è—¥å±€ Logo" onerror="this.style.display='none'; this.parentNode.innerText='ğŸŒ³ å¤§æ¨¹å¥åº·è³¼ç‰©ç¶²';"> 
        </div>
        <div class="search-bar">
            <input type="text" placeholder="æœå°‹å•†å“ã€å“ç‰Œæˆ–è¼¸å…¥ç—‡ç‹€ (Demoç‰ˆ)...">
            <button>æœå°‹</button>
        </div>
        <div class="nav-links">æœƒå“¡ç™»å…¥ | è³¼ç‰©è»Š(0) | é–€å¸‚æŸ¥è©¢</div>
    </div>
</header>

<div class="main-content">
    <div class="banner">ğŸ‰ Pharma.Duck å°é´¨è—¥å¸« å…¨æ–°ä¸Šç·šï¼</div>
    <h2 style="color: #333;">ç†±é–€ä¿å¥å“å°ˆå€</h2>
    <div class="product-grid" id="productGrid"></div>
</div>

<div class="duck-assistant-large" onclick="toggleChat()">
    <img src="images/my_duck.png" alt="Ph.D é´¨é´¨å°è³¼" onerror="this.src='https://placehold.co/200x200/F39800/white?text=Duck';">
</div>

<div class="duck-chat-window" id="chatWindow">
    <div class="chat-header">
        <div class="chat-header-img">
            <img src="images/my_duck.png" alt="é´¨" onerror="this.src='https://placehold.co/50x50/F39800/white?text=D';">
        </div>
        <div style="font-weight: bold;">Ph.D é´¨å­è—¥å¸« (ç·šä¸Šè«®è©¢)</div>
        <div style="margin-left: auto; cursor: pointer; font-size: 20px;" onclick="toggleChat()">âœ•</div>
    </div>

    <div class="chat-messages" id="chatMsg">
        <div class="msg msg-duck">
            <div class="bubble">æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„å°ˆå±¬å¥åº·é¡§å• Ph.D é´¨é´¨ã€‚ğŸ¦†<br>ä»Šå¤©æƒ³æ‰¾ä»€éº¼æ–¹é¢çš„ä¿å¥å“å‘¢ï¼Ÿæˆ‘å¯ä»¥å¹«æ‚¨æ¯”è¼ƒæˆåˆ†å–”ï¼âœ¨</div>
        </div>
    </div>
    
    <div class="typing" id="typingIndicator">é´¨é´¨æ­£åœ¨æ€è€ƒä¸­... ğŸ¤”</div>

    <div class="chat-input-area">
        <input type="text" id="userInput" placeholder="è¼¸å…¥ç—‡ç‹€ï¼Œä¾‹ï¼šæƒ³æ‰¾ç›Šç”ŸèŒ..." onkeypress="handleKeyPress(event)">
        <button onclick="sendMessage()">â¤</button>
    </div>
</div>

<footer>
    <div class="team-info">åœ˜éšŠï¼šä¸€é´¨treeåƒ ğŸ¦†</div>
    <div>å˜‰å—è—¥ç†å¤§å­¸ è—¥å­¸ç³»</div>
    <div style="font-size: 12px; color: #aaa; margin-top: 5px;">
        æœ¬ç¶²é åƒ…ä¾›ã€å¤§æ¨¹è—¥å±€ç¬¬ä¸‰å±†å‰µæ„ç«¶è³½ã€‘å±•ç¤ºä½¿ç”¨ï¼ŒéçœŸå¯¦è³¼ç‰©ç¶²ç«™<br>
        Copyright Â© 2026 Pharma.Duck. All rights reserved.
    </div>
</footer>

<script>
    // === 1. å•†å“è³‡æ–™åº« (ä½¿ç”¨ç·šä¸Šå‡åœ–ï¼Œç¢ºä¿ä¸€å®šçœ‹å¾—åˆ°åœ–ç‰‡) ===
    // åœ–ç‰‡ä¾†æºä½¿ç”¨ placehold.coï¼Œæœƒè‡ªå‹•ç”Ÿæˆå¸¶æ–‡å­—çš„åœ–ç‰‡
    const products = [
        // å¬°å¹¼å…’
        { id: 1, name: "å¦™åˆ©æ•£ ç›Šç”ŸèŒ (å¬°å¹¼å…’å°ˆç”¨)", price: 850, tag: "å¬°å¹¼å…’", image: "https://placehold.co/150x150/fff9c4/333?text=Baby+Bio", target: "baby", allergy: "none" },
        // å…’ç«¥
        { id: 2, name: "å°å…’åˆ©æ’’çˆ¾ ç¶œåˆç¶­ä»–å‘½", price: 450, tag: "å…’ç«¥æˆé•·", image: "https://placehold.co/150x150/ffcc80/333?text=Kids+Vit", target: "child", allergy: "none" },
        // ç”·æ€§æˆäºº
        { id: 3, name: "å…‹è£œ Bç¾¤+é‹… (ç”·æ€§å°ˆç”¨)", price: 680, tag: "ç”·æ€§æ´»åŠ›", image: "https://placehold.co/150x150/90caf9/333?text=Men+B+Zinc", target: "adult_m", allergy: "none" },
        // å¥³æ€§æˆäºº
        { id: 4, name: "å·§å…‹åŠ› è† åŸè›‹ç™½ç²‰", price: 990, tag: "å¥³æ€§ç¾éº—", image: "https://placehold.co/150x150/f48fb1/333?text=Women+Collagen", target: "adult_f", allergy: "none" },
        // é•·è¼©/è€äºº
        { id: 5, name: "æŒºç«‹ UC-II é—œéµè¿·ä½ éŒ ", price: 1580, tag: "é•·è¼©é—œç¯€", image: "https://placehold.co/150x150/e6ee9c/333?text=Senior+UCII", target: "senior", allergy: "none" },
        // ä¸€èˆ¬é€šç”¨
        { id: 6, name: "å¤§æ¨¹ æ·±æµ·é­šæ²¹ 1000mg", price: 1200, tag: "å¿ƒè¡€ç®¡", image: "https://placehold.co/150x150/80cbc4/333?text=Fish+Oil", target: "adult,senior", allergy: "none" },
        // è…¸èƒƒé€šç”¨
        { id: 7, name: "è‹¥å…ƒéŒ  Wakamoto", price: 600, tag: "è…¸èƒƒæ¶ˆåŒ–", image: "https://placehold.co/150x150/ce93d8/333?text=Wakamoto", target: "adult", allergy: "none" },
         // éæ•æ›¿ä»£
        { id: 8, name: "æ¤ç‰©æ€§ è‘¡è„ç³–èƒº", price: 700, tag: "å…¨ç´ å¯é£Ÿ", image: "https://placehold.co/150x150/a5d6a7/333?text=Plant+Gluco", target: "senior", allergy: "none" }
    ];

    // åˆå§‹åŒ–å•†å“åˆ—è¡¨
    const grid = document.getElementById('productGrid');
    products.forEach(p => {
        grid.innerHTML += `
            <div class="product-card" id="pid-${p.id}">
                <div class="tag-rec">é´¨é´¨æ¨è–¦ âœ¨</div>
                <img class="p-img" src="${p.image}" alt="${p.name}">
                <div class="p-name">${p.name}</div>
                <div class="p-price">$${p.price}</div>
            </div>
        `;
    });

    // èŠå¤©å®¤é–‹é—œ
    function toggleChat() {
        const win = document.getElementById('chatWindow');
        win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
        if (win.style.display === 'flex') {
            document.getElementById('userInput').focus();
        }
    }

    function handleKeyPress(e) {
        if (e.key === 'Enter') sendMessage();
    }

    // === 2. å°è©±é‚è¼¯ (ä¿®æ­£äº† function æ‹¼å­—éŒ¯èª¤) ===
    let chatStep = 0; 
    let userProfile = { symptom: "", who: "", allergy: "" }; 

    function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        if (!text) return;

        addMessage(text, 'user');
        input.value = '';
        showTyping(true);

        setTimeout(() => {
            let response = "";
            let recProductId = null;
            let recReasonText = "";

            // æ­¥é©Ÿ 0: å•ç—‡ç‹€
            if (chatStep === 0) {
                userProfile.symptom = text;
                if(text.includes("é‡ä¾†")) {
                    response = "å°è©±å·²é‡ç½®ï¼è«‹å‘Šè¨´æˆ‘æ‚¨çš„ç—‡ç‹€ï¼Ÿ";
                    chatStep = 0;
                } else {
                    response = `æ”¶åˆ°ï¼Œæƒ³æ‰¾ã€Œ${text}ã€ç›¸é—œç”¢å“ã€‚ğŸ¦†<br>è«‹å•æ˜¯çµ¦èª°ç”¨çš„ï¼Ÿ<br>(ä¾‹å¦‚ï¼šå¬°å…’ã€å°å­©ã€ç”·æ€§ã€å¥³æ€§ã€è€äººï¼Ÿ)`;
                    chatStep = 1;
                }
            } 
            
            // æ­¥é©Ÿ 1: å•å°è±¡
            else if (chatStep === 1) {
                userProfile.who = text;
                response = "äº†è§£ã€‚æœ€å¾Œç¢ºèªï¼Œæœ‰å°è—¥ç‰©æˆ–é£Ÿç‰©**éæ•**å—ï¼Ÿ(è‹¥ç„¡è«‹è¼¸å…¥ã€Œç„¡ã€)";
                chatStep = 2;
            }

            // æ­¥é©Ÿ 2: å•éæ• -> æ¨è–¦
            else if (chatStep === 2) {
                userProfile.allergy = text;
                chatStep = 0; // é‡ç½®

                // --- æ™ºæ…§æ¨è–¦é‚è¼¯ ---
                const who = userProfile.who;
                const sym = userProfile.symptom;

                // 1. å¬°å¹¼å…’æ¨è–¦
                if (who.includes("å¬°") || who.includes("å¯¶")) {
                    response = "å¯¶å¯¶çš„è…¸èƒƒè¼ƒæ•æ„Ÿï¼Œæ¨è–¦ **å¦™åˆ©æ•£**ï¼Œç´°ç²‰å¥½é¤µé£Ÿï¼Œå»ºç«‹å¥åº·è…¸é“ï¼";
                    recProductId = 1; 
                    recReasonText = "å°ˆç‚ºå¬°å¹¼å…’è¨­è¨ˆï¼Œå®‰å…¨æº«å’Œã€‚";
                }
                // 2. å°å­©æ¨è–¦
                else if (who.includes("å°") || who.includes("ç«¥")) {
                    response = "å°æœ‹å‹æˆé•·æœŸéœ€è¦å‡è¡¡ç‡Ÿé¤Šï¼Œæ¨è–¦ **å°å…’åˆ©æ’’çˆ¾**ï¼Œå¥½åƒåˆç‡Ÿé¤Šï¼";
                    recProductId = 2;
                    recReasonText = "å…’ç«¥å°ˆç”¨é…æ–¹ï¼Œè£œè¶³æˆé•·æ‰€éœ€ã€‚";
                }
                // 3. ç”·æ€§æ¨è–¦
                else if (who.includes("ç”·")) {
                    response = "é‡å°ç”·æ€§ä¸Šç­æ—ï¼Œæ¨è–¦ **Bç¾¤+é‹…**ï¼Œå¢å¼·é«”åŠ›èˆ‡ç²¾ç¥ï¼";
                    recProductId = 3;
                    recReasonText = "åŠ å¼·é‹…é…æ–¹ï¼Œç”·æ€§é¦–é¸ã€‚";
                }
                // 4. å¥³æ€§æ¨è–¦
                else if (who.includes("å¥³")) {
                    response = "æ„›ç¾çš„å¥³æ€§æ¨è–¦ **è† åŸè›‹ç™½ç²‰**ï¼Œç¶­æŒæ°£è‰²ç´…æ½¤ï¼";
                    recProductId = 4;
                    recReasonText = "å«éµé…æ–¹ï¼Œå°ˆç‚ºå¥³æ€§è¨­è¨ˆã€‚";
                }
                // 5. è€äºº/é•·è¼© (é‡å°é—œç¯€)
                else if (who.includes("è€") || who.includes("é•·") || who.includes("çˆº") || who.includes("å¥¶") || who.includes("å¬¤") || who.includes("å…¬")) {
                    if (userProfile.allergy.includes("è¦") || userProfile.allergy.includes("èŸ¹")|| userProfile.allergy.includes("æµ·é®®")) {
                        response = "å› ç‚ºæœ‰**è¦èŸ¹éæ•**ï¼Œä¸å»ºè­°åƒè‘¡è„ç³–èƒºã€‚å¼·çƒˆæ¨è–¦ **UC-II**ï¼Œé›è»Ÿéª¨èƒå–ï¼Œå®‰å…¨æœ‰æ•ˆï¼";
                        recProductId = 5;
                        recReasonText = "âš ï¸ é¿é–‹éæ•åŸçš„æœ€ä½³é¸æ“‡ï¼";
                    } else {
                        response = "é•·è¼©ä¿é¤Šé—œéµï¼Œæ¨è–¦ **å¤§æ¨¹æ·±æµ·é­šæ²¹** æˆ–è‘¡è„ç³–èƒºï¼Œæ½¤æ»‘é—œéµéƒ¨ä½ã€‚";
                        recProductId = 6;
                        recReasonText = "é«˜æ¿ƒåº¦ Omega-3ï¼ŒæŠ—ç™¼ç‚ä¿é¤Šã€‚";
                    }
                }
                // é è¨­
                else {
                    response = "æ ¹æ“šæ‚¨çš„éœ€æ±‚ï¼Œæ¨è–¦é€™æ¬¾ç†±éŠ·å•†å“ï¼";
                    recProductId = 7;
                    recReasonText = "å±…å®¶å¸¸å‚™è‰¯è—¥ã€‚";
                }
            }

            showTyping(false);
            addMessage(response, 'duck');

            if (recProductId) {
                const p = products.find(i => i.id === recProductId);
                if(p) addRecCard(p, recReasonText);
                
                // æ²å‹•æ•ˆæœ
                const targetCard = document.getElementById(`pid-${recProductId}`);
                if(targetCard){
                    document.querySelectorAll('.product-card').forEach(c => c.style.border = "2px solid transparent");
                    targetCard.style.border = "2px solid #F39800";
                    setTimeout(() => targetCard.scrollIntoView({behavior: "smooth", block: "center"}), 500);
                }
            }

        }, 800);
    }

    function addMessage(text, sender) {
        const chatBox = document.getElementById('chatMsg');
        chatBox.innerHTML += `<div class="msg msg-${sender}"><div class="bubble">${text}</div></div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function addRecCard(product, reason) {
        const chatBox = document.getElementById('chatMsg');
        chatBox.innerHTML += `
            <div class="msg msg-duck">
                <div class="rec-card" onclick="alert('å°å¼•è‡³å•†å“é : ${product.name}')">
                    <img src="${product.image}" alt="${product.name}">
                    <div class="rec-info">
                        <div class="rec-title">${product.name}</div>
                        <div class="rec-reason">${reason}</div>
                        <div class="rec-action">é»æ“ŠæŸ¥çœ‹ ></div>
                    </div>
                </div>
            </div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function showTyping(show) {
        document.getElementById('typingIndicator').style.display = show ? 'block' : 'none';
    }
</script>

</body>
</html>
